/**
 * @file Firestore Security Rules
 * @description This ruleset secures the 'messages' and 'subscribers' collections.
 *   It allows public write access for creating new documents, enabling features like a public contact form
 *   and newsletter subscription. Read, update, and delete operations are disabled for all users to protect data privacy.
 *
 * @dataStructure
 * - /messages/{messageId}: Stores messages received through the website.
 * - /subscribers/{subscriberId}: Stores information about users who have subscribed to email updates.
 *
 * @keySecurityDecisions
 * - Public write access (create) is granted to both collections to allow form submissions from unauthenticated users.
 * - Read, update, and delete operations are denied to prevent unauthorized access, modification, or removal of data.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows anyone to create a message, but denies read, update, and delete operations.
     * @path /messages/{messageId}
     * @allow (create) if true
     * @deny (get, list, update, delete)
     * @principle Allows public creation for contact forms while protecting submitted data.
     */
    match /messages/{messageId} {
      allow create: if true;
      allow get, list, update, delete: if false;
    }

    /**
     * @description Allows anyone to subscribe, but denies read, update, and delete operations.
     * @path /subscribers/{subscriberId}
     * @allow (create) if true
     * @deny (get, list, update, delete)
     * @principle Allows public creation for newsletter sign-ups while protecting subscriber emails.
     */
    match /subscribers/{subscriberId} {
      allow create: if true;
      allow get, list, update, delete: if false;
    }
  }
}
